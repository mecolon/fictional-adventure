name: SFCC Code Deployment-TEST

on:
  workflow_dispatch: # to allow running this workflow manually 
  # push:  <== excluded "push:", "branches:" and "-main"  to prevent the workflow from running automatically on commit.
  # branches:
  #    - main
jobs:

  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18

      - name: Install sfcc-ci
        run: npm install -g sfcc-ci

      - name: Show Variable
        run: echo ${{ vars.RELEASE_BUILD_NUMBER }}
      - name: show decoded B64 encoded secret  
        run: echo "${{ secrets.BASE64_P12 }}" | base64 -d > ${{ vars.CERT_FILENAME }}
        
      - run: cat ${{ vars.CERT_FILENAME }}
# -----------------------
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Create or update file
        uses: actions/add-commit@v6
        with:
          message: "Add file using actions/add-commit."
          add: "new_file.txt"
          commit: true
          # Create a file on the fly
          # syntax: file_content >> filename
          # You can also use "create-a-file" action for this
          # See documentation for more advanced usage
          run: echo "Content for the new file." > new_file.txt
